%\subsection{k Nearest Neighbour Query}


%%%%%%%%%%%%
% 1NN CU
%%%%%%%%%%%%
\begin{figure*}[thb]
	\pgfplotsset{
		every tick label/.append style={font=\scriptsize},
		every axis/.append style={xmode=log, ymode=log, ymin={1e2}, ymax={1e6}, 
				height=7cm, width=6.4cm, grid=major, xlabel={dataset size $N$}, font=\scriptsize, }
	}
\begin{subfigure}[t]{0.33\textwidth}
\begin{tikzpicture}
\begin{axis}[ 
			ylabel={queries per second},
			legend columns=3,
			legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/PHC-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/RSS-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/RSZ-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/PHC_IPP-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
%	\addplot+[CBF] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/CBF-P-OSM(1.0,0.0,null).txt};
%	\addlegendentry{CBF} 
%	\addplot+[CBZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/CBZ-P-OSM(1.0,0.0,null).txt};
%	\addlegendentry{CBZ} 
	\addplot+[KDL] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/KD_LEVY-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{KDL} 
	\addplot+[KDS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/KD_SAVA-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{KDS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/QTZ-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{QZ} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/STRZ-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{STR} 
	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/XTS-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{XTS} 
	\legend{} %disable legend
\end{axis}
\end{tikzpicture}
	\centering
	\caption{2D OSM-P}
	\label{fig:1NNQueryOSM-P}
\end{subfigure}
%
%
\begin{subfigure}[t]{0.33\textwidth}
\begin{tikzpicture}
	\pgfplotsset{every axis legend/.append style={ at={(0.05,0.02)}, anchor=south west}}
\begin{axis}[ 
		legend columns=3,
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/PHC-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/RSS-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/RSZ-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/PHC_IPP-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
%	\addplot+[CBF] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/CBF-P-CUBE(1.0,0.0,null).txt};
%	\addlegendentry{CBF} 
%	\addplot+[CBZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/CBZ-P-CUBE(1.0,0.0,null).txt};
%	\addlegendentry{CBZ} 
	\addplot+[KDL] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/KD_LEVY-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{KDL} 
	\addplot+[KDS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/KD_SAVA-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{KDS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/QTZ-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{QZ} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/STRZ-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{STR} 
	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/XTS-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{XTS} 
%	\legend{} %disable legend
\end{axis}
\end{tikzpicture}
	\centering
	\caption{3D CUBE-P}
	\label{fig:1NNQueryCUBE-P}
\end{subfigure}
%
%
\begin{subfigure}[t]{0.33\textwidth}
\begin{tikzpicture}
\begin{axis}[ 
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/PHC-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PH-P} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/RSS-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSS-P} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/RSZ-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSZ-P} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/PHC_IPP-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PHM-P} 
%	\addplot+[CBF] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/CBF-P-CLUSTER(5.0,0.0,null).txt};
%	\addlegendentry{CBF-P} 
%	\addplot+[CBZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/CBZ-P-CLUSTER(5.0,0.0,null).txt};
%	\addlegendentry{CBZ-P} 
	\addplot+[KDL] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/KD_LEVY-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{KDL-P} 
	\addplot+[KDS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/KD_SAVA-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{KDS-P} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/QTZ-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{QZ-P} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/STRZ-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{STR-P} 
	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeP/XTS-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{XTS-P} 
	\legend{} %disable legend
\end{axis}
\end{tikzpicture}
	\centering
	\caption{3D CLUSTER-P}
	\label{fig:1NNQueryCL-P}
\end{subfigure}
	\caption{1NN query rates for the OSM ($d=2$), CUBE ($d=3$) and CLUSTER ($d=3$) datasets}
	\label{fig:1NNQueryPerEntryP}
\end{figure*}



%%%%%%%%%%%%
% 10NN CU
%%%%%%%%%%%%
\begin{figure*}[thb]
	\pgfplotsset{
		every tick label/.append style={font=\scriptsize},
		every axis/.append style={xmode=log, ymode=log, ymin={1e2}, ymax={1e6}, 
				height=7cm, width=6.4cm, grid=major, xlabel={dataset size $N$}, font=\scriptsize, }
	}
\begin{subfigure}[t]{0.33\textwidth}
\begin{tikzpicture}
\begin{axis}[ 
			ylabel={queries per second},
		legend columns=3,
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/PHC-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/RSS-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/RSZ-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/PHC_IPP-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
%	\addplot+[CBF] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/CBF-P-OSM(1.0,0.0,null).txt};
%	\addlegendentry{CBF} 
%	\addplot+[CBZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/CBZ-P-OSM(1.0,0.0,null).txt};
%	\addlegendentry{CBZ} 
	\addplot+[KDL] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/KD_LEVY-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{KDL} 
	\addplot+[KDS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/KD_SAVA-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{KDS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/QTZ-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{QZ} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/STRZ-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{STR} 
	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/XTS-P-OSM(1.0,0.0,null).txt};
	\addlegendentry{XTS} 
	\legend{} %disable legend
\end{axis}
\end{tikzpicture}
	\centering
	\caption{2D OSM-P}
	\label{fig:10NNQueryOSM-P}
\end{subfigure}
%
%
\begin{subfigure}[t]{0.33\textwidth}
\begin{tikzpicture}
	\pgfplotsset{every axis legend/.append style={ at={(0.05,0.02)}, anchor=south west}}
\begin{axis}[ 
		legend columns=3,
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/PHC-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/RSS-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/RSZ-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/PHC_IPP-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
%	\addplot+[CBF] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/CBF-P-CUBE(1.0,0.0,null).txt};
%	\addlegendentry{CBF} 
%	\addplot+[CBZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/CBZ-P-CUBE(1.0,0.0,null).txt};
%	\addlegendentry{CBZ} 
	\addplot+[KDL] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/KD_LEVY-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{KDL} 
	\addplot+[KDS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/KD_SAVA-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{KDS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/QTZ-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{QZP} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/STRZ-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{STR} 
	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/XTS-P-CUBE(1.0,0.0,null).txt};
	\addlegendentry{XTS} 
%	\legend{} %disable legend
\end{axis}
\end{tikzpicture}
	\centering
	\caption{3D CUBE-P}
	\label{fig:10NNQueryCUBE-P}
\end{subfigure}
%
%
\begin{subfigure}[t]{0.33\textwidth}
\begin{tikzpicture}
\begin{axis}[ 
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/PHC-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PH-P} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/RSS-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSS-P} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/RSZ-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSZ-P} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/PHC_IPP-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PHM-P} 
%	\addplot+[CBF] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/CBF-P-CLUSTER(5.0,0.0,null).txt};
%	\addlegendentry{CBF-P} 
%	\addplot+[CBZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/CBZ-P-CLUSTER(5.0,0.0,null).txt};
%	\addlegendentry{CBZ-P} 
	\addplot+[KDL] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/KD_LEVY-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{KDL-P} 
	\addplot+[KDS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/KD_SAVA-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{KDS-P} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/QTZ-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{QZ-P} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/STRZ-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{STR-P} 
	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeP/XTS-P-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{XTS-P} 
	\legend{} %disable legend
\end{axis}
\end{tikzpicture}
	\centering
	\caption{3D CLUSTER-P}
	\label{fig:10NNQueryCL-P}
\end{subfigure}
	\caption{10NN query rates for the OSM ($d=2$), CUBE ($d=3$) and CLUSTER ($d=3$) datasets}
	\label{fig:10NNQueryPerEntryP}
\end{figure*}




\begin{figure*}[thb]
	\pgfplotsset{
		every tick label/.append style={font=\scriptsize},
		every axis/.append style={xmode=log, ymode=log, ymin={1e1}, ymax={1e6}, 
				height=7cm, width=6.4cm, grid=major, xlabel={dataset size $N$}, font=\scriptsize, }
	}
\begin{subfigure}[t]{0.33\textwidth}
	\begin{tikzpicture} 
	\pgfplotsset{every axis legend/.append style={ at={(0.05,0.05)}, anchor=south west}}
		\begin{axis}[ 
			ylabel={queries per second},
			legend columns=3,
			legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/PHC-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/RSS-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/RSZ-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/PHC_IPP-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/STRZ-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{STR} 
%	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/XTS-R-OSM(1.0,0.0,null).txt};
%	\addlegendentry{XTS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/QTZ-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{QZ} 
		\end{axis} 
	\end{tikzpicture}
	\centering
	\caption{OSM-R}
	\label{fig:1NNQueryOSM-R}
%\end{figure}
\end{subfigure}
\begin{subfigure}[t]{0.33\textwidth}
%\begin{figure}[thb]
	\begin{tikzpicture} 
	\pgfplotsset{every axis legend/.append style={ at={(0.05,0.95)}, anchor=north west}}
		\begin{axis}[ 
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/PHC-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/RSS-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/RSZ-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/PHC_IPP-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/STRZ-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{STR} 
%	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/XTS-R-CUBE(1.0,0.0,null).txt};
%	\addlegendentry{XTS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/QTZ-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{QZ} 
	\legend{} %disable legend
		\end{axis} 
	\end{tikzpicture}
	\centering
	\caption{CUBE-R}
	\label{fig:1NNQueryCU-R}
%\end{figure}
\end{subfigure}
\begin{subfigure}[t]{0.33\textwidth}
%\begin{figure}[thb]
	\begin{tikzpicture} 
	\pgfplotsset{every axis legend/.append style={ at={(0.05,0.95)}, anchor=north west}}
		\begin{axis}[ 
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/PHC-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/RSS-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/RSZ-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/PHC_IPP-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PHM} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/STRZ-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{STR} 
%	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/XTS-R-CLUSTER(5.0,0.0,null).txt};
%	\addlegendentry{XTS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{1-NN2}, col sep=tab] {sizeR/QTZ-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{QZ} 
	\legend{} %disable legend
		\end{axis} 
	\end{tikzpicture}
	\centering
	\caption{CLUSTER-R}
	\label{fig:1NNQueryCL-R}
%\end{figure}
\end{subfigure}
	\caption{1NN query rates for the OSM ($d=2$), CUBE ($d=3$) and CLUSTER ($d=3$) datasets}
	\label{fig:1NNQueryPerEntry-R}
\end{figure*}


\begin{figure*}[thb]
	\pgfplotsset{
		every tick label/.append style={font=\scriptsize},
		every axis/.append style={xmode=log, ymode=log, ymin={1e1}, ymax={1e6}, 
				height=7cm, width=6.4cm, grid=major, xlabel={dataset size $N$}, font=\scriptsize, }
	}
\begin{subfigure}[t]{0.33\textwidth}
	\begin{tikzpicture} 
	\pgfplotsset{every axis legend/.append style={ at={(0.02,0.02)}, anchor=south west}}
		\begin{axis}[ 
			ylabel={queries per second},
			legend columns=3,
			legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/PHC-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/RSS-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/RSZ-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/PHC_IPP-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/STRZ-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{STR} 
%	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/XTS-R-OSM(1.0,0.0,null).txt};
%	\addlegendentry{XTS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/QTZ-R-OSM(1.0,0.0,null).txt};
	\addlegendentry{QZ} 
		\end{axis} 
	\end{tikzpicture}
	\centering
	\caption{OSM-R}
	\label{fig:10NNQueryOSM-R}
%\end{figure}
\end{subfigure}
\begin{subfigure}[t]{0.33\textwidth}
%\begin{figure}[thb]
	\begin{tikzpicture} 
	\pgfplotsset{every axis legend/.append style={ at={(0.05,0.95)}, anchor=north west}}
		\begin{axis}[ 
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/PHC-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/RSS-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/RSZ-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/PHC_IPP-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{PHM} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/STRZ-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{STR} 
%	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/XTS-R-CUBE(1.0,0.0,null).txt};
%	\addlegendentry{XTS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/QTZ-R-CUBE(1.0,0.0,null).txt};
	\addlegendentry{QZ} 
	\legend{} %disable legend
		\end{axis} 
	\end{tikzpicture}
	\centering
	\caption{CUBE-R}
	\label{fig:10NNQueryCU-R}
%\end{figure}
\end{subfigure}
\begin{subfigure}[t]{0.33\textwidth}
%\begin{figure}[thb]
	\begin{tikzpicture} 
	\pgfplotsset{every axis legend/.append style={ at={(0.05,0.95)}, anchor=north west}}
		\begin{axis}[ 
		legend style={draw=none},
		] 
	\addplot+[PH] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/PHC-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PH} 
	\addplot+[RSS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/RSS-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSS} 
	\addplot+[RSZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/RSZ-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{RSZ} 
	\addplot+[PHM] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/PHC_IPP-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{PHM} 
	\addplot+[STRZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/STRZ-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{STR} 
%	\addplot+[XTS] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/XTS-R-CLUSTER(5.0,0.0,null).txt};
%	\addlegendentry{XTS} 
	\addplot+[QTZ] table [selectcoords={0}{6},x=N,y expr=1e9/\thisrow{10-NN2}, col sep=tab] {sizeR/QTZ-R-CLUSTER(5.0,0.0,null).txt};
	\addlegendentry{QZ} 
	\legend{} %disable legend
		\end{axis} 
	\end{tikzpicture}
	\centering
	\caption{CLUSTER-R}
	\label{fig:10NNQueryCL-R}
%\end{figure}
\end{subfigure}
	\caption{10NN query rates for the OSM ($d=2$), CUBE ($d=3$) and CLUSTER ($d=3$) datasets}
	\label{fig:10NNQueryPerEntry-R}
\end{figure*}


